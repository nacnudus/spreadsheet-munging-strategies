<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5.1 An example formatting lookup | Spreadsheet Munging Strategies</title>
  <meta name="description" content="5.1 An example formatting lookup | Spreadsheet Munging Strategies" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="5.1 An example formatting lookup | Spreadsheet Munging Strategies" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5.1 An example formatting lookup | Spreadsheet Munging Strategies" />
  
  
  

<meta name="author" content="Duncan Garmonsway" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="formatting.html"/>
<link rel="next" href="common-formats.html"/>
<script src="libs/header-attrs-2.1/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-45097885-10"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-45097885-10');
</script>



<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="1" data-path="setup.html"><a href="setup.html"><i class="fa fa-check"></i><b>1</b> Setup</a>
<ul>
<li class="chapter" data-level="1.1" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i><b>1.1</b> Packages</a></li>
<li class="chapter" data-level="1.2" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>1.2</b> Data</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="tidyish.html"><a href="tidyish.html"><i class="fa fa-check"></i><b>2</b> Tidy-ish tables</a>
<ul>
<li class="chapter" data-level="2.1" data-path="tidy-clean.html"><a href="tidy-clean.html"><i class="fa fa-check"></i><b>2.1</b> Clean &amp; tidy tables</a></li>
<li class="chapter" data-level="2.2" data-path="almost-tidy-tables.html"><a href="almost-tidy-tables.html"><i class="fa fa-check"></i><b>2.2</b> Almost-tidy tables</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="almost-tidy-tables.html"><a href="almost-tidy-tables.html#transposed-headers-in-the-first-row-data-extends-to-the-right"><i class="fa fa-check"></i><b>2.2.1</b> Transposed (headers in the first row, data extends to the right)</a></li>
<li class="chapter" data-level="2.2.2" data-path="almost-tidy-tables.html"><a href="almost-tidy-tables.html#other-stuff-on-the-same-sheet"><i class="fa fa-check"></i><b>2.2.2</b> Other stuff on the same sheet</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="tidy-formatted-rows.html"><a href="tidy-formatted-rows.html"><i class="fa fa-check"></i><b>2.3</b> Meaningfully formatted rows</a></li>
<li class="chapter" data-level="2.4" data-path="tidy-formatted-cells.html"><a href="tidy-formatted-cells.html"><i class="fa fa-check"></i><b>2.4</b> Meaningfully formatted cells</a></li>
<li class="chapter" data-level="2.5" data-path="layered-formatting.html"><a href="layered-formatting.html"><i class="fa fa-check"></i><b>2.5</b> Layered meaningful formatting</a></li>
<li class="chapter" data-level="2.6" data-path="hierarchies-in-formatting.html"><a href="hierarchies-in-formatting.html"><i class="fa fa-check"></i><b>2.6</b> Hierarchies in formatting</a></li>
<li class="chapter" data-level="2.7" data-path="tidy-sentinel.html"><a href="tidy-sentinel.html"><i class="fa fa-check"></i><b>2.7</b> Sentinel values in non-text columns</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="pivot.html"><a href="pivot.html"><i class="fa fa-check"></i><b>3</b> Pivot tables</a>
<ul>
<li class="chapter" data-level="3.1" data-path="pivot-simple.html"><a href="pivot-simple.html"><i class="fa fa-check"></i><b>3.1</b> Simple unpivoting</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="pivot-simple.html"><a href="pivot-simple.html#two-clear-rows-of-text-column-headers-left-aligned"><i class="fa fa-check"></i><b>3.1.1</b> Two clear rows of text column headers, left-aligned</a></li>
<li class="chapter" data-level="3.1.2" data-path="pivot-simple.html"><a href="pivot-simple.html#two-clear-rows-and-columns-of-text-headers-top-aligned-and-left-aligned"><i class="fa fa-check"></i><b>3.1.2</b> Two clear rows and columns of text headers, top-aligned and left-aligned</a></li>
<li class="chapter" data-level="3.1.3" data-path="pivot-simple.html"><a href="pivot-simple.html#multiple-rows-or-columns-of-headers-with-meaningful-formatting"><i class="fa fa-check"></i><b>3.1.3</b> Multiple rows or columns of headers, with meaningful formatting</a></li>
<li class="chapter" data-level="3.1.4" data-path="pivot-simple.html"><a href="pivot-simple.html#mixed-headers-and-notes-in-the-same-rowcolumn-distinguished-by-formatting"><i class="fa fa-check"></i><b>3.1.4</b> Mixed headers and notes in the same row/column, distinguished by formatting</a></li>
<li class="chapter" data-level="3.1.5" data-path="pivot-simple.html"><a href="pivot-simple.html#mixed-levels-of-headers-in-the-same-rowcolumn-distinguished-by-formatting"><i class="fa fa-check"></i><b>3.1.5</b> Mixed levels of headers in the same row/column, distinguished by formatting</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="pivot-complex.html"><a href="pivot-complex.html"><i class="fa fa-check"></i><b>3.2</b> Complex unpivoting</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="pivot-complex.html"><a href="pivot-complex.html#two-clear-rows-of-text-column-headers-left-aligned-1"><i class="fa fa-check"></i><b>3.2.1</b> Two clear rows of text column headers, left-aligned</a></li>
<li class="chapter" data-level="3.2.2" data-path="pivot-complex.html"><a href="pivot-complex.html#two-clear-columns-of-text-row-headers-top-aligned"><i class="fa fa-check"></i><b>3.2.2</b> Two clear columns of text row headers, top-aligned</a></li>
<li class="chapter" data-level="3.2.3" data-path="pivot-complex.html"><a href="pivot-complex.html#two-clear-rows-and-columns-of-text-headers-top-aligned-and-left-aligned-1"><i class="fa fa-check"></i><b>3.2.3</b> Two clear rows and columns of text headers, top-aligned and left-aligned</a></li>
<li class="chapter" data-level="3.2.4" data-path="pivot-complex.html"><a href="pivot-complex.html#centre-aligned-headers"><i class="fa fa-check"></i><b>3.2.4</b> Centre-aligned headers</a></li>
<li class="chapter" data-level="3.2.5" data-path="pivot-complex.html"><a href="pivot-complex.html#multiple-rows-or-columns-of-headers-with-meaningful-formatting-1"><i class="fa fa-check"></i><b>3.2.5</b> Multiple rows or columns of headers, with meaningful formatting</a></li>
<li class="chapter" data-level="3.2.6" data-path="pivot-complex.html"><a href="pivot-complex.html#mixed-headers-and-notes-in-the-same-rowcolumn-distinguished-by-formatting-1"><i class="fa fa-check"></i><b>3.2.6</b> Mixed headers and notes in the same row/column, distinguished by formatting</a></li>
<li class="chapter" data-level="3.2.7" data-path="pivot-complex.html"><a href="pivot-complex.html#mixed-levels-of-headers-in-the-same-rowcolumn-distinguished-by-formatting-1"><i class="fa fa-check"></i><b>3.2.7</b> Mixed levels of headers in the same row/column, distinguished by formatting</a></li>
<li class="chapter" data-level="3.2.8" data-path="pivot-complex.html"><a href="pivot-complex.html#repeated-rowscolumns-of-headers-within-the-table"><i class="fa fa-check"></i><b>3.2.8</b> Repeated rows/columns of headers within the table</a></li>
<li class="chapter" data-level="3.2.9" data-path="pivot-complex.html"><a href="pivot-complex.html#headers-amongst-the-data"><i class="fa fa-check"></i><b>3.2.9</b> Headers amongst the data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="small-multiples.html"><a href="small-multiples.html"><i class="fa fa-check"></i><b>4</b> Small multiples</a>
<ul>
<li class="chapter" data-level="4.1" data-path="small-multiples-with-all-headers-present-for-each-multiple.html"><a href="small-multiples-with-all-headers-present-for-each-multiple.html"><i class="fa fa-check"></i><b>4.1</b> Small multiples with all headers present for each multiple</a></li>
<li class="chapter" data-level="4.2" data-path="same-table-in-several-worksheetsfiles-using-the-sheetfile-name.html"><a href="same-table-in-several-worksheetsfiles-using-the-sheetfile-name.html"><i class="fa fa-check"></i><b>4.2</b> Same table in several worksheets/files (using the sheet/file name)</a></li>
<li class="chapter" data-level="4.3" data-path="same-table-in-several-worksheetsfiles-but-in-different-positions.html"><a href="same-table-in-several-worksheetsfiles-but-in-different-positions.html"><i class="fa fa-check"></i><b>4.3</b> Same table in several worksheets/files but in different positions</a></li>
<li class="chapter" data-level="4.4" data-path="implied-multiples.html"><a href="implied-multiples.html"><i class="fa fa-check"></i><b>4.4</b> Implied multiples</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="formatting.html"><a href="formatting.html"><i class="fa fa-check"></i><b>5</b> Formatting</a>
<ul>
<li class="chapter" data-level="5.1" data-path="an-example-formatting-lookup.html"><a href="an-example-formatting-lookup.html"><i class="fa fa-check"></i><b>5.1</b> An example formatting lookup</a></li>
<li class="chapter" data-level="5.2" data-path="common-formats.html"><a href="common-formats.html"><i class="fa fa-check"></i><b>5.2</b> Common formats</a></li>
<li class="chapter" data-level="5.3" data-path="in-cell-formatting.html"><a href="in-cell-formatting.html"><i class="fa fa-check"></i><b>5.3</b> In-cell formatting</a></li>
<li class="chapter" data-level="5.4" data-path="multiple-pieces-of-information-in-a-single-cell-with-meaningful-formatting.html"><a href="multiple-pieces-of-information-in-a-single-cell-with-meaningful-formatting.html"><i class="fa fa-check"></i><b>5.4</b> Multiple pieces of information in a single cell, with meaningful formatting</a></li>
<li class="chapter" data-level="5.5" data-path="superscript-symbols.html"><a href="superscript-symbols.html"><i class="fa fa-check"></i><b>5.5</b> Superscript symbols</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-validation.html"><a href="data-validation.html"><i class="fa fa-check"></i><b>6</b> Data validation</a></li>
<li class="chapter" data-level="7" data-path="formulas.html"><a href="formulas.html"><i class="fa fa-check"></i><b>7</b> Formulas</a></li>
<li class="chapter" data-level="8" data-path="other-gotchas.html"><a href="other-gotchas.html"><i class="fa fa-check"></i><b>8</b> Other gotchas</a>
<ul>
<li class="chapter" data-level="8.1" data-path="non-text-headers-e-g-dates.html"><a href="non-text-headers-e-g-dates.html"><i class="fa fa-check"></i><b>8.1</b> Non-text headers e.g. dates</a></li>
<li class="chapter" data-level="8.2" data-path="data-embedded-in-comments.html"><a href="data-embedded-in-comments.html"><i class="fa fa-check"></i><b>8.2</b> Data embedded in comments</a></li>
<li class="chapter" data-level="8.3" data-path="named-ranges.html"><a href="named-ranges.html"><i class="fa fa-check"></i><b>8.3</b> Named ranges</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="case-studies.html"><a href="case-studies.html"><i class="fa fa-check"></i><b>9</b> Case studies</a>
<ul>
<li class="chapter" data-level="9.1" data-path="australian-marriage-survey.html"><a href="australian-marriage-survey.html"><i class="fa fa-check"></i><b>9.1</b> Australian Marriage Survey</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="australian-marriage-survey.html"><a href="australian-marriage-survey.html#the-full-code-listing"><i class="fa fa-check"></i><b>9.1.1</b> The full code listing</a></li>
<li class="chapter" data-level="9.1.2" data-path="australian-marriage-survey.html"><a href="australian-marriage-survey.html#step-by-step"><i class="fa fa-check"></i><b>9.1.2</b> Step by step</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="vaccinations.html"><a href="vaccinations.html"><i class="fa fa-check"></i><b>9.2</b> Vaccinations</a></li>
<li class="chapter" data-level="9.3" data-path="us-crime.html"><a href="us-crime.html"><i class="fa fa-check"></i><b>9.3</b> US Crime</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="us-crime.html"><a href="us-crime.html#us-crime-2"><i class="fa fa-check"></i><b>9.3.1</b> Table 2</a></li>
<li class="chapter" data-level="9.3.2" data-path="us-crime.html"><a href="us-crime.html#us-crime-3"><i class="fa fa-check"></i><b>9.3.2</b> Table 3</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="toronto-transit-commission.html"><a href="toronto-transit-commission.html"><i class="fa fa-check"></i><b>9.4</b> Toronto Transit Commission</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="toronto-transit-commission.html"><a href="toronto-transit-commission.html#the-full-code-listing-1"><i class="fa fa-check"></i><b>9.4.1</b> The full code listing</a></li>
<li class="chapter" data-level="9.4.2" data-path="toronto-transit-commission.html"><a href="toronto-transit-commission.html#step-by-step-1"><i class="fa fa-check"></i><b>9.4.2</b> Step by step</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="ground-water.html"><a href="ground-water.html"><i class="fa fa-check"></i><b>9.5</b> Ground water</a></li>
<li class="chapter" data-level="9.6" data-path="cashflows.html"><a href="cashflows.html"><i class="fa fa-check"></i><b>9.6</b> Cashflows</a></li>
<li class="chapter" data-level="9.7" data-path="school-performance.html"><a href="school-performance.html"><i class="fa fa-check"></i><b>9.7</b> School performance</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="school-performance.html"><a href="school-performance.html#sheet-1"><i class="fa fa-check"></i><b>9.7.1</b> Sheet 1</a></li>
<li class="chapter" data-level="9.7.2" data-path="school-performance.html"><a href="school-performance.html#sheet-2"><i class="fa fa-check"></i><b>9.7.2</b> Sheet 2</a></li>
<li class="chapter" data-level="9.7.3" data-path="school-performance.html"><a href="school-performance.html#sheet-3"><i class="fa fa-check"></i><b>9.7.3</b> Sheet 3</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Spreadsheet Munging Strategies</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="an-example-formatting-lookup" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> An example formatting lookup</h2>
<p><img src="images/formatting.png" /></p>
<p>This example shows how to look up whether a cell is bold.</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="an-example-formatting-lookup.html#cb312-1"></a>path &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;worked-examples.xlsx&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;unpivotr&quot;</span>)</span>
<span id="cb312-2"><a href="an-example-formatting-lookup.html#cb312-2"></a>path &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;worked-examples.xlsx&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;unpivotr&quot;</span>)</span>
<span id="cb312-3"><a href="an-example-formatting-lookup.html#cb312-3"></a>cells &lt;-</span>
<span id="cb312-4"><a href="an-example-formatting-lookup.html#cb312-4"></a><span class="st">  </span><span class="kw">xlsx_cells</span>(path, <span class="dt">sheet =</span> <span class="st">&quot;formatting&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb312-5"><a href="an-example-formatting-lookup.html#cb312-5"></a><span class="st">  </span><span class="kw">select</span>(row, col, character, style_format, local_format_id)</span>
<span id="cb312-6"><a href="an-example-formatting-lookup.html#cb312-6"></a>cells</span></code></pre></div>
<pre><code>## # A tibble: 14 x 5
##      row   col character          style_format     local_format_id
##    &lt;int&gt; &lt;int&gt; &lt;chr&gt;              &lt;chr&gt;                      &lt;int&gt;
##  1     1     1 bold               Normal                         6
##  2     2     1 italic             Normal                         8
##  3     3     1 underline          Normal                        51
##  4     4     1 strikethrough      Normal                        52
##  5     5     1 red text           Normal                        12
##  6     6     1 font size 14       Normal                        53
##  7     7     1 font arial         Normal                        54
##  8     8     1 yellow fill        Normal                        11
##  9     9     1 black border       Normal                        43
## 10    10     1 thick border       Normal                        55
## 11    11     1 dashed border      Normal                        56
## 12    12     1 row height 30      Normal                         1
## 13    13     2 column width 16.76 Normal                         1
## 14    14     1 Bad&#39; style         Explanatory Text              57</code></pre>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="an-example-formatting-lookup.html#cb314-1"></a>formats &lt;-<span class="st"> </span><span class="kw">xlsx_formats</span>(path)</span>
<span id="cb314-2"><a href="an-example-formatting-lookup.html#cb314-2"></a>bold &lt;-<span class="st"> </span>formats<span class="op">$</span>local<span class="op">$</span>font<span class="op">$</span>bold <span class="co"># The list of lists of lists of vectors</span></span>
<span id="cb314-3"><a href="an-example-formatting-lookup.html#cb314-3"></a>bold</span></code></pre></div>
<pre><code>##  [1] FALSE  TRUE  TRUE FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE
## [13] FALSE FALSE  TRUE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [25] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [37] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [49] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE</code></pre>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="an-example-formatting-lookup.html#cb316-1"></a><span class="kw">mutate</span>(cells, <span class="dt">bold =</span> bold[local_format_id])</span></code></pre></div>
<pre><code>## # A tibble: 14 x 6
##      row   col character          style_format     local_format_id bold 
##    &lt;int&gt; &lt;int&gt; &lt;chr&gt;              &lt;chr&gt;                      &lt;int&gt; &lt;lgl&gt;
##  1     1     1 bold               Normal                         6 TRUE 
##  2     2     1 italic             Normal                         8 FALSE
##  3     3     1 underline          Normal                        51 FALSE
##  4     4     1 strikethrough      Normal                        52 FALSE
##  5     5     1 red text           Normal                        12 FALSE
##  6     6     1 font size 14       Normal                        53 FALSE
##  7     7     1 font arial         Normal                        54 FALSE
##  8     8     1 yellow fill        Normal                        11 FALSE
##  9     9     1 black border       Normal                        43 FALSE
## 10    10     1 thick border       Normal                        55 FALSE
## 11    11     1 dashed border      Normal                        56 FALSE
## 12    12     1 row height 30      Normal                         1 FALSE
## 13    13     2 column width 16.76 Normal                         1 FALSE
## 14    14     1 Bad&#39; style         Explanatory Text              57 FALSE</code></pre>
<p>A quick way to see what formatting definitions exist is to use <code>str()</code>. (Scroll
past this for now – you don’t need to memorise it).</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="an-example-formatting-lookup.html#cb318-1"></a>formats &lt;-<span class="st"> </span><span class="kw">xlsx_formats</span>(path)</span>
<span id="cb318-2"><a href="an-example-formatting-lookup.html#cb318-2"></a><span class="kw">str</span>(formats)</span></code></pre></div>
<pre><code>## List of 2
##  $ local:List of 6
##   ..$ numFmt    : chr [1:59] &quot;General&quot; &quot;General&quot; &quot;General&quot; &quot;General&quot; ...
##   ..$ font      :List of 10
##   .. ..$ bold     : logi [1:59] FALSE TRUE TRUE FALSE FALSE TRUE ...
##   .. ..$ italic   : logi [1:59] FALSE FALSE FALSE FALSE FALSE FALSE ...
##   .. ..$ underline: chr [1:59] NA NA NA NA ...
##   .. ..$ strike   : logi [1:59] FALSE FALSE FALSE FALSE FALSE FALSE ...
##   .. ..$ vertAlign: chr [1:59] NA NA NA NA ...
##   .. ..$ size     : num [1:59] 11 11 11 11 11 11 11 11 11 11 ...
##   .. ..$ color    :List of 4
##   .. .. ..$ rgb    : chr [1:59] &quot;FF000000&quot; &quot;FF000000&quot; &quot;FF000000&quot; &quot;FF000000&quot; ...
##   .. .. ..$ theme  : chr [1:59] NA NA NA NA ...
##   .. .. ..$ indexed: int [1:59] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. ..$ tint   : num [1:59] NA NA NA NA NA NA NA NA NA NA ...
##   .. ..$ name     : chr [1:59] &quot;Calibri&quot; &quot;Calibri&quot; &quot;Calibri&quot; &quot;Calibri&quot; ...
##   .. ..$ family   : int [1:59] 2 2 2 2 2 2 2 2 2 2 ...
##   .. ..$ scheme   : chr [1:59] NA NA NA NA ...
##   ..$ fill      :List of 2
##   .. ..$ patternFill :List of 3
##   .. .. ..$ fgColor    :List of 4
##   .. .. .. ..$ rgb    : chr [1:59] NA NA NA NA ...
##   .. .. .. ..$ theme  : chr [1:59] NA NA NA NA ...
##   .. .. .. ..$ indexed: int [1:59] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. ..$ tint   : num [1:59] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. ..$ bgColor    :List of 4
##   .. .. .. ..$ rgb    : chr [1:59] NA NA NA NA ...
##   .. .. .. ..$ theme  : chr [1:59] NA NA NA NA ...
##   .. .. .. ..$ indexed: int [1:59] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. ..$ tint   : num [1:59] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. ..$ patternType: chr [1:59] NA NA NA NA ...
##   .. ..$ gradientFill:List of 8
##   .. .. ..$ type  : chr [1:59] NA NA NA NA ...
##   .. .. ..$ degree: int [1:59] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. ..$ left  : num [1:59] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. ..$ right : num [1:59] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. ..$ top   : num [1:59] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. ..$ bottom: num [1:59] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. ..$ stop1 :List of 2
##   .. .. .. ..$ position: num [1:59] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. ..$ color   :List of 4
##   .. .. .. .. ..$ rgb    : chr [1:59] NA NA NA NA ...
##   .. .. .. .. ..$ theme  : chr [1:59] NA NA NA NA ...
##   .. .. .. .. ..$ indexed: int [1:59] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. .. ..$ tint   : num [1:59] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. ..$ stop2 :List of 2
##   .. .. .. ..$ position: num [1:59] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. ..$ color   :List of 4
##   .. .. .. .. ..$ rgb    : chr [1:59] NA NA NA NA ...
##   .. .. .. .. ..$ theme  : chr [1:59] NA NA NA NA ...
##   .. .. .. .. ..$ indexed: int [1:59] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. .. ..$ tint   : num [1:59] NA NA NA NA NA NA NA NA NA NA ...
##   ..$ border    :List of 12
##   .. ..$ diagonalDown: logi [1:59] FALSE FALSE FALSE FALSE FALSE FALSE ...
##   .. ..$ diagonalUp  : logi [1:59] FALSE FALSE FALSE FALSE FALSE FALSE ...
##   .. ..$ outline     : logi [1:59] FALSE FALSE FALSE FALSE FALSE FALSE ...
##   .. ..$ left        :List of 2
##   .. .. ..$ style: chr [1:59] NA &quot;thin&quot; NA NA ...
##   .. .. ..$ color:List of 4
##   .. .. .. ..$ rgb    : chr [1:59] NA &quot;FF000000&quot; NA NA ...
##   .. .. .. ..$ theme  : chr [1:59] NA NA NA NA ...
##   .. .. .. ..$ indexed: int [1:59] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. ..$ tint   : num [1:59] NA NA NA NA NA NA NA NA NA NA ...
##   .. ..$ right       :List of 2
##   .. .. ..$ style: chr [1:59] NA &quot;thin&quot; NA NA ...
##   .. .. ..$ color:List of 4
##   .. .. .. ..$ rgb    : chr [1:59] NA &quot;FF000000&quot; NA NA ...
##   .. .. .. ..$ theme  : chr [1:59] NA NA NA NA ...
##   .. .. .. ..$ indexed: int [1:59] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. ..$ tint   : num [1:59] NA NA NA NA NA NA NA NA NA NA ...
##   .. ..$ start       :List of 2
##   .. .. ..$ style: chr [1:59] NA NA NA NA ...
##   .. .. ..$ color:List of 4
##   .. .. .. ..$ rgb    : chr [1:59] NA NA NA NA ...
##   .. .. .. ..$ theme  : chr [1:59] NA NA NA NA ...
##   .. .. .. ..$ indexed: int [1:59] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. ..$ tint   : num [1:59] NA NA NA NA NA NA NA NA NA NA ...
##   .. ..$ end         :List of 2
##   .. .. ..$ style: chr [1:59] NA NA NA NA ...
##   .. .. ..$ color:List of 4
##   .. .. .. ..$ rgb    : chr [1:59] NA NA NA NA ...
##   .. .. .. ..$ theme  : chr [1:59] NA NA NA NA ...
##   .. .. .. ..$ indexed: int [1:59] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. ..$ tint   : num [1:59] NA NA NA NA NA NA NA NA NA NA ...
##   .. ..$ top         :List of 2
##   .. .. ..$ style: chr [1:59] NA &quot;thin&quot; NA NA ...
##   .. .. ..$ color:List of 4
##   .. .. .. ..$ rgb    : chr [1:59] NA &quot;FF000000&quot; NA NA ...
##   .. .. .. ..$ theme  : chr [1:59] NA NA NA NA ...
##   .. .. .. ..$ indexed: int [1:59] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. ..$ tint   : num [1:59] NA NA NA NA NA NA NA NA NA NA ...
##   .. ..$ bottom      :List of 2
##   .. .. ..$ style: chr [1:59] NA NA &quot;thin&quot; NA ...
##   .. .. ..$ color:List of 4
##   .. .. .. ..$ rgb    : chr [1:59] NA NA &quot;FF000000&quot; NA ...
##   .. .. .. ..$ theme  : chr [1:59] NA NA NA NA ...
##   .. .. .. ..$ indexed: int [1:59] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. ..$ tint   : num [1:59] NA NA NA NA NA NA NA NA NA NA ...
##   .. ..$ diagonal    :List of 2
##   .. .. ..$ style: chr [1:59] NA NA NA NA ...
##   .. .. ..$ color:List of 4
##   .. .. .. ..$ rgb    : chr [1:59] NA NA NA NA ...
##   .. .. .. ..$ theme  : chr [1:59] NA NA NA NA ...
##   .. .. .. ..$ indexed: int [1:59] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. ..$ tint   : num [1:59] NA NA NA NA NA NA NA NA NA NA ...
##   .. ..$ vertical    :List of 2
##   .. .. ..$ style: chr [1:59] NA NA NA NA ...
##   .. .. ..$ color:List of 4
##   .. .. .. ..$ rgb    : chr [1:59] NA NA NA NA ...
##   .. .. .. ..$ theme  : chr [1:59] NA NA NA NA ...
##   .. .. .. ..$ indexed: int [1:59] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. ..$ tint   : num [1:59] NA NA NA NA NA NA NA NA NA NA ...
##   .. ..$ horizontal  :List of 2
##   .. .. ..$ style: chr [1:59] NA NA NA NA ...
##   .. .. ..$ color:List of 4
##   .. .. .. ..$ rgb    : chr [1:59] NA NA NA NA ...
##   .. .. .. ..$ theme  : chr [1:59] NA NA NA NA ...
##   .. .. .. ..$ indexed: int [1:59] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. ..$ tint   : num [1:59] NA NA NA NA NA NA NA NA NA NA ...
##   ..$ alignment :List of 8
##   .. ..$ horizontal     : chr [1:59] &quot;general&quot; &quot;center&quot; &quot;general&quot; &quot;general&quot; ...
##   .. ..$ vertical       : chr [1:59] &quot;bottom&quot; &quot;bottom&quot; &quot;bottom&quot; &quot;bottom&quot; ...
##   .. ..$ wrapText       : logi [1:59] FALSE FALSE FALSE FALSE FALSE FALSE ...
##   .. ..$ readingOrder   : chr [1:59] &quot;context&quot; &quot;context&quot; &quot;context&quot; &quot;context&quot; ...
##   .. ..$ indent         : int [1:59] 0 0 0 0 0 0 0 0 0 0 ...
##   .. ..$ justifyLastLine: logi [1:59] FALSE FALSE FALSE FALSE FALSE FALSE ...
##   .. ..$ shrinkToFit    : logi [1:59] FALSE FALSE FALSE FALSE FALSE FALSE ...
##   .. ..$ textRotation   : int [1:59] 0 0 0 0 0 0 0 0 0 0 ...
##   ..$ protection:List of 2
##   .. ..$ locked: logi [1:59] TRUE TRUE TRUE TRUE TRUE TRUE ...
##   .. ..$ hidden: logi [1:59] FALSE FALSE FALSE FALSE FALSE FALSE ...
##  $ style:List of 6
##   ..$ numFmt    : Named chr [1:2] &quot;General&quot; &quot;General&quot;
##   .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   ..$ font      :List of 10
##   .. ..$ bold     : Named logi [1:2] FALSE FALSE
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. ..$ italic   : Named logi [1:2] FALSE FALSE
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. ..$ underline: Named chr [1:2] NA NA
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. ..$ strike   : Named logi [1:2] FALSE FALSE
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. ..$ vertAlign: Named chr [1:2] NA NA
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. ..$ size     : Named num [1:2] 11 11
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. ..$ color    :List of 4
##   .. .. ..$ rgb    : Named chr [1:2] &quot;FF000000&quot; &quot;FF9C0006&quot;
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. ..$ theme  : Named chr [1:2] NA NA
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. ..$ indexed: Named int [1:2] NA NA
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. ..$ tint   : Named num [1:2] NA NA
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. ..$ name     : Named chr [1:2] &quot;Calibri&quot; &quot;Calibri&quot;
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. ..$ family   : Named int [1:2] 2 2
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. ..$ scheme   : Named chr [1:2] NA NA
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   ..$ fill      :List of 2
##   .. ..$ patternFill :List of 3
##   .. .. ..$ fgColor    :List of 4
##   .. .. .. ..$ rgb    : Named chr [1:2] NA &quot;FFFFC7CE&quot;
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. ..$ theme  : Named chr [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. ..$ indexed: Named int [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. ..$ tint   : Named num [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. ..$ bgColor    :List of 4
##   .. .. .. ..$ rgb    : Named chr [1:2] NA &quot;FFCCCCFF&quot;
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. ..$ theme  : Named chr [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. ..$ indexed: Named int [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. ..$ tint   : Named num [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. ..$ patternType: Named chr [1:2] NA &quot;solid&quot;
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. ..$ gradientFill:List of 8
##   .. .. ..$ type  : Named chr [1:2] NA NA
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. ..$ degree: Named int [1:2] NA NA
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. ..$ left  : Named num [1:2] NA NA
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. ..$ right : Named num [1:2] NA NA
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. ..$ top   : Named num [1:2] NA NA
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. ..$ bottom: Named num [1:2] NA NA
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. ..$ stop1 :List of 2
##   .. .. .. ..$ position: Named num [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. ..$ color   :List of 4
##   .. .. .. .. ..$ rgb    : Named chr [1:2] NA NA
##   .. .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. .. ..$ theme  : Named chr [1:2] NA NA
##   .. .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. .. ..$ indexed: Named int [1:2] NA NA
##   .. .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. .. ..$ tint   : Named num [1:2] NA NA
##   .. .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. ..$ stop2 :List of 2
##   .. .. .. ..$ position: Named num [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. ..$ color   :List of 4
##   .. .. .. .. ..$ rgb    : Named chr [1:2] NA NA
##   .. .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. .. ..$ theme  : Named chr [1:2] NA NA
##   .. .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. .. ..$ indexed: Named int [1:2] NA NA
##   .. .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. .. ..$ tint   : Named num [1:2] NA NA
##   .. .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   ..$ border    :List of 12
##   .. ..$ diagonalDown: Named logi [1:2] FALSE FALSE
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. ..$ diagonalUp  : Named logi [1:2] FALSE FALSE
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. ..$ outline     : Named logi [1:2] FALSE FALSE
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. ..$ left        :List of 2
##   .. .. ..$ style: Named chr [1:2] NA NA
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. ..$ color:List of 4
##   .. .. .. ..$ rgb    : Named chr [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. ..$ theme  : Named chr [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. ..$ indexed: Named int [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. ..$ tint   : Named num [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. ..$ right       :List of 2
##   .. .. ..$ style: Named chr [1:2] NA NA
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. ..$ color:List of 4
##   .. .. .. ..$ rgb    : Named chr [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. ..$ theme  : Named chr [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. ..$ indexed: Named int [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. ..$ tint   : Named num [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. ..$ start       :List of 2
##   .. .. ..$ style: Named chr [1:2] NA NA
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. ..$ color:List of 4
##   .. .. .. ..$ rgb    : Named chr [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. ..$ theme  : Named chr [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. ..$ indexed: Named int [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. ..$ tint   : Named num [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. ..$ end         :List of 2
##   .. .. ..$ style: Named chr [1:2] NA NA
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. ..$ color:List of 4
##   .. .. .. ..$ rgb    : Named chr [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. ..$ theme  : Named chr [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. ..$ indexed: Named int [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. ..$ tint   : Named num [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. ..$ top         :List of 2
##   .. .. ..$ style: Named chr [1:2] NA NA
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. ..$ color:List of 4
##   .. .. .. ..$ rgb    : Named chr [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. ..$ theme  : Named chr [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. ..$ indexed: Named int [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. ..$ tint   : Named num [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. ..$ bottom      :List of 2
##   .. .. ..$ style: Named chr [1:2] NA NA
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. ..$ color:List of 4
##   .. .. .. ..$ rgb    : Named chr [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. ..$ theme  : Named chr [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. ..$ indexed: Named int [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. ..$ tint   : Named num [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. ..$ diagonal    :List of 2
##   .. .. ..$ style: Named chr [1:2] NA NA
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. ..$ color:List of 4
##   .. .. .. ..$ rgb    : Named chr [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. ..$ theme  : Named chr [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. ..$ indexed: Named int [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. ..$ tint   : Named num [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. ..$ vertical    :List of 2
##   .. .. ..$ style: Named chr [1:2] NA NA
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. ..$ color:List of 4
##   .. .. .. ..$ rgb    : Named chr [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. ..$ theme  : Named chr [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. ..$ indexed: Named int [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. ..$ tint   : Named num [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. ..$ horizontal  :List of 2
##   .. .. ..$ style: Named chr [1:2] NA NA
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. ..$ color:List of 4
##   .. .. .. ..$ rgb    : Named chr [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. ..$ theme  : Named chr [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. ..$ indexed: Named int [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. .. .. ..$ tint   : Named num [1:2] NA NA
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   ..$ alignment :List of 8
##   .. ..$ horizontal     : Named chr [1:2] &quot;general&quot; &quot;general&quot;
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. ..$ vertical       : Named chr [1:2] &quot;bottom&quot; &quot;bottom&quot;
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. ..$ wrapText       : Named logi [1:2] FALSE FALSE
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. ..$ readingOrder   : Named chr [1:2] &quot;context&quot; &quot;context&quot;
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. ..$ indent         : Named int [1:2] 0 0
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. ..$ justifyLastLine: Named logi [1:2] FALSE FALSE
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. ..$ shrinkToFit    : Named logi [1:2] FALSE FALSE
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. ..$ textRotation   : Named int [1:2] 0 0
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   ..$ protection:List of 2
##   .. ..$ locked: Named logi [1:2] TRUE TRUE
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;
##   .. ..$ hidden: Named logi [1:2] FALSE FALSE
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Normal&quot; &quot;Explanatory Text&quot;</code></pre>
<p>Why is this so complicated? For one thing, there are too many types of
formatting available to include in the data frame given by <code>xlsx_cells()</code>.</p>
<p>Consider borders: each cell can have a border on each of its four sides, as well
as through the middle of the cell horizontally, vertically, diagonally up and
diagonally down. Each border can have its own colour and linetype. Colour can
be expressed as an RGB value, a theme number with or without a tint, or an index
number.</p>
<p>To express that in a data frame would take (4 sides + 4 through the middle) * (4
ways to express colour + 1 linetype) = 40 columns. Just for borders.</p>
<p>Instead, Excel dynamically defines combinations of formatting, as they occur,
and gives ID numbers to those combinations. Each cell has a formatting ID,
which is used to look up its particular combination of formats. Note that this
means two cells that are both bold can have different formatting IDs, e.g. if
one is also italic.</p>
<p>There is also a hierarchy of formatting. The first formatting to be applied is
the ‘style’. Every cell has a style, which by default is the ‘normal’ style.
You can reformat all cells of the ‘normal’ style at once by updating the
‘normal’ style. Style formats are available under <code>xlsx_formats()$style</code></p>
<p>When you modify the format of a particular cell, then that modification is local
to that cell. The cell’s local formatting is available under
<code>xlsx_formats()$local</code>. Both <code>$style</code> and <code>$local</code> have the same structure, so
it’s easy to switch from checking a cell’s style-level formatting to its local
formatting.</p>
<p>Here’s an example of looking up both the local bold formatting and the
style-level bold formatting of a cell.</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="an-example-formatting-lookup.html#cb320-1"></a>path &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;worked-examples.xlsx&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;unpivotr&quot;</span>)</span>
<span id="cb320-2"><a href="an-example-formatting-lookup.html#cb320-2"></a>cells &lt;-</span>
<span id="cb320-3"><a href="an-example-formatting-lookup.html#cb320-3"></a><span class="st">  </span><span class="kw">xlsx_cells</span>(path, <span class="dt">sheet =</span> <span class="st">&quot;formatting&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb320-4"><a href="an-example-formatting-lookup.html#cb320-4"></a><span class="st">  </span><span class="kw">select</span>(row, col, character, style_format, local_format_id) <span class="op">%&gt;%</span></span>
<span id="cb320-5"><a href="an-example-formatting-lookup.html#cb320-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(row <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, col <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb320-6"><a href="an-example-formatting-lookup.html#cb320-6"></a>cells</span></code></pre></div>
<pre><code>## # A tibble: 1 x 5
##     row   col character style_format local_format_id
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;     &lt;chr&gt;                  &lt;int&gt;
## 1     1     1 bold      Normal                     6</code></pre>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="an-example-formatting-lookup.html#cb322-1"></a>formats &lt;-<span class="st"> </span><span class="kw">xlsx_formats</span>(path)</span>
<span id="cb322-2"><a href="an-example-formatting-lookup.html#cb322-2"></a></span>
<span id="cb322-3"><a href="an-example-formatting-lookup.html#cb322-3"></a>local_bold &lt;-<span class="st"> </span>formats<span class="op">$</span>local<span class="op">$</span>font<span class="op">$</span>bold</span>
<span id="cb322-4"><a href="an-example-formatting-lookup.html#cb322-4"></a>local_bold</span></code></pre></div>
<pre><code>##  [1] FALSE  TRUE  TRUE FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE
## [13] FALSE FALSE  TRUE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [25] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [37] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [49] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE</code></pre>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="an-example-formatting-lookup.html#cb324-1"></a>style_bold &lt;-<span class="st"> </span>formats<span class="op">$</span>style<span class="op">$</span>font<span class="op">$</span>bold</span>
<span id="cb324-2"><a href="an-example-formatting-lookup.html#cb324-2"></a>style_bold</span></code></pre></div>
<pre><code>##           Normal Explanatory Text 
##            FALSE            FALSE</code></pre>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="an-example-formatting-lookup.html#cb326-1"></a><span class="kw">mutate</span>(cells,</span>
<span id="cb326-2"><a href="an-example-formatting-lookup.html#cb326-2"></a>       <span class="dt">style_bold =</span> style_bold[style_format],</span>
<span id="cb326-3"><a href="an-example-formatting-lookup.html#cb326-3"></a>       <span class="dt">local_bold =</span> local_bold[local_format_id])</span></code></pre></div>
<pre><code>## # A tibble: 1 x 7
##     row   col character style_format local_format_id style_bold local_bold
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;     &lt;chr&gt;                  &lt;int&gt; &lt;lgl&gt;      &lt;lgl&gt;     
## 1     1     1 bold      Normal                     6 FALSE      TRUE</code></pre>
<p>Most of the time you will use the local formatting. You only need to check the
style formatting when styles have been used in the spreadsheet (rare) and you
want to ignore any local modifications of that style for particular cells.</p>
<p>Conditional formatting is an obvious omission. It isn’t supported by tidyxl
because it doesn’t encode any new information; it’s responds to cell values,
which you already have. If you think you need it, feel free to open an
<a href="https://github.com/nacnudus/tidyxl/issues">issue</a>.</p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="formatting.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="common-formats.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"],
"google": true,
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/nacnudus/spreadsheet-munging-strategies/edit/master/formatting.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["spreadsheet-munging-strategies.pdf", "spreadsheet-munging-strategies.epub"],
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": true
});
});
</script>

</body>

</html>
